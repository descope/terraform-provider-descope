// Code generated by terragen. DO NOT EDIT.

package connectors_test

import (
	"regexp"
	"testing"

	"github.com/descope/terraform-provider-descope/tools/testacc"
	"github.com/hashicorp/terraform-plugin-testing/helper/resource"
)

func TestConnectors(t *testing.T) {
	p := testacc.Project(t)
	testacc.Run(t,
		resource.TestStep{
			Config: p.Config(),
			Check: p.Check(map[string]any{
				"connectors": testacc.AttributeIsNotSet,
			}),
		},
		resource.TestStep{
			Config: p.Config(`
				connectors = {}
			`),
			Check: p.Check(map[string]any{
				"connectors.%": {{ len .Connectors }},
			}),
		},
{{- range .Connectors }}{{ $c := . }}
		resource.TestStep{
			Config: p.Config(`
				connectors = {
					"{{.AttributeName}}": [
						{
							name = "Test {{.ID}} Connector"
							description = "A description for the {{.DataName}} connector"
							{{- range .Fields }}
    						{{.AttributeName}} = {{.GetTestAssignment}}
							{{- end }}
						}
					]
				}
			`),
{{- if .BuiltIn }}
			ExpectError: regexp.MustCompile(`Incorrect attribute value type`),
{{- else }}
			Check: p.Check(map[string]any{
				"connectors.{{.AttributeName}}.#": 1,
				"connectors.{{.AttributeName}}.0": map[string]any{
					"id": testacc.AttributeHasPrefix("CI"),
					"name": "Test {{.ID}} Connector",
					"description": "A description for the {{.DataName}} connector",
					{{- range .Fields }}
					{{.GetTestCheck }},
					{{- end }}
				},
			}),
{{- end}}
		},
{{- end }}
		resource.TestStep{
			Config: p.Config(`
				connectors = {}
			`),
			Check: p.Check(map[string]any{
				"connectors.%": {{ len .Connectors }},
			}),
		},
	)
}
